{
  "version": 3,
  "sources": ["../../src/utils/storage.ts", "../../src/popup.ts"],
  "sourcesContent": ["/**\n * storage.ts\n *\n * Helper functions for interacting with chrome.storage.sync.\n * Provides typed access to the extension's settings.\n */\n\nexport interface Tab {\n    id: string;\n    title: string;       // Display Name\n    type: 'label' | 'hash'; // 'label' for legacy/simple, 'hash' for custom views\n    value: string;       // The label name or full hash string\n}\n\n// Legacy interface for migration\ninterface LegacyTabLabel {\n    name: string;\n    id: string;\n    displayName?: string;\n}\n\nexport interface Settings {\n    tabs: Tab[];\n    // Legacy support for migration\n    labels?: LegacyTabLabel[];\n    theme: 'system' | 'light' | 'dark';\n    showUnreadCount: boolean;\n}\n\nconst DEFAULT_SETTINGS: Settings = {\n    tabs: [],\n    theme: 'system',\n    showUnreadCount: false\n};\n\n/**\n * Retrieves the current settings from storage.\n * Handles migration from legacy 'labels' to 'tabs'.\n */\nexport async function getSettings(): Promise<Settings> {\n    return new Promise((resolve) => {\n        chrome.storage.sync.get(null, (items) => { // Get all items to check for legacy 'labels'\n            const settings = { ...DEFAULT_SETTINGS, ...items } as Settings;\n\n            // Migration Logic: If 'labels' exists but 'tabs' is empty/missing\n            if (settings.labels && settings.labels.length > 0 && (!settings.tabs || settings.tabs.length === 0)) {\n                console.log('Migrating legacy labels to tabs...');\n                settings.tabs = settings.labels.map(l => ({\n                    id: l.id,\n                    title: l.displayName || l.name,\n                    type: 'label',\n                    value: l.name\n                }));\n                // Clear legacy labels to prevent re-migration\n                delete settings.labels;\n                // Save migrated settings immediately\n                chrome.storage.sync.set(settings);\n            }\n\n            resolve(settings);\n        });\n    });\n}\n\n/**\n * Saves the settings to storage.\n * Merges the provided settings with existing ones.\n */\nexport async function saveSettings(newSettings: Partial<Settings>): Promise<void> {\n    const currentSettings = await getSettings();\n    const mergedSettings = { ...currentSettings, ...newSettings };\n    return new Promise((resolve) => {\n        chrome.storage.sync.set(mergedSettings, () => {\n            resolve();\n        });\n    });\n}\n\n/**\n * Adds a new tab to the list.\n */\nexport async function addTab(title: string, value: string, type: 'label' | 'hash' = 'label'): Promise<void> {\n    const settings = await getSettings();\n    const newTab: Tab = {\n        id: crypto.randomUUID(),\n        title: title.trim(),\n        value: value.trim(),\n        type: type\n    };\n\n    // Avoid duplicates based on value\n    if (!settings.tabs.some((t) => t.value === newTab.value)) {\n        settings.tabs.push(newTab);\n        await saveSettings(settings);\n    }\n}\n\n/**\n * Removes a tab by ID.\n */\nexport async function removeTab(tabId: string): Promise<void> {\n    const settings = await getSettings();\n    settings.tabs = settings.tabs.filter((t) => t.id !== tabId);\n    await saveSettings(settings);\n}\n\n/**\n * Updates an existing tab.\n */\nexport async function updateTab(tabId: string, updates: Partial<Tab>): Promise<void> {\n    const settings = await getSettings();\n    const index = settings.tabs.findIndex((t) => t.id === tabId);\n    if (index !== -1) {\n        settings.tabs[index] = { ...settings.tabs[index], ...updates };\n        await saveSettings(settings);\n    }\n}\n\n/**\n * Updates the order of tabs.\n */\nexport async function updateTabOrder(newTabs: Tab[]): Promise<void> {\n    const settings = await getSettings();\n    settings.tabs = newTabs;\n    await saveSettings(settings);\n}\n", "/**\n * popup.ts\n *\n * Script for the extension popup.\n * Handles theme selection and tab configuration.\n */\n\nimport { getSettings, saveSettings, addTab, removeTab, updateTabOrder, Settings, Tab } from './utils/storage';\n\n// --- Theme Logic ---\nconst themeSelect = document.getElementById('theme-select') as HTMLSelectElement;\n\nasync function initTheme() {\n    const settings = await getSettings();\n    if (themeSelect) {\n        themeSelect.value = settings.theme;\n        themeSelect.addEventListener('change', async () => {\n            const newTheme = themeSelect.value as 'system' | 'light' | 'dark';\n            await saveSettings({ theme: newTheme });\n        });\n    }\n}\n\n// --- Tab Configuration Logic ---\nconst tabInput = document.getElementById('new-tab-input') as HTMLInputElement;\nconst addTabBtn = document.getElementById('add-tab-btn') as HTMLButtonElement;\nconst tabsList = document.getElementById('tabs-list') as HTMLUListElement;\n\nasync function initTabs() {\n    if (!tabsList) return; // Guard against missing elements\n\n    await renderTabsList();\n\n    if (addTabBtn) {\n        addTabBtn.addEventListener('click', async () => {\n            await handleAddTab();\n        });\n    }\n\n    if (tabInput) {\n        tabInput.addEventListener('keypress', async (e) => {\n            if (e.key === 'Enter') {\n                await handleAddTab();\n            }\n        });\n    }\n}\n\nasync function handleAddTab() {\n    if (!tabInput) return;\n\n    let value = tabInput.value.trim();\n    if (value) {\n        // Remove \"label:\" prefix if present (case-insensitive)\n        if (value.toLowerCase().startsWith('label:')) {\n            value = value.substring(6).trim();\n        }\n\n        if (value) {\n            await addTab(value, value, 'label');\n            tabInput.value = '';\n            await renderTabsList();\n        }\n    }\n}\n\nasync function renderTabsList() {\n    const settings = await getSettings();\n    if (!tabsList) return;\n\n    tabsList.innerHTML = '';\n\n    settings.tabs.forEach((tab, index) => {\n        const li = document.createElement('li');\n        li.className = 'label-item';\n        li.setAttribute('draggable', 'true');\n        li.dataset.index = index.toString();\n\n        // Drag Handle\n        const dragHandle = document.createElement('div');\n        dragHandle.className = 'drag-handle';\n        dragHandle.innerHTML = '<svg viewBox=\"0 0 24 24\"><path d=\"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"/></svg>';\n        li.appendChild(dragHandle);\n\n        const nameSpan = document.createElement('span');\n        nameSpan.className = 'label-name';\n        nameSpan.textContent = tab.title;\n        // Show type if it's a hash tab\n        if (tab.type === 'hash') {\n            const typeSpan = document.createElement('small');\n            typeSpan.style.color = '#888';\n            typeSpan.style.marginLeft = '4px';\n            typeSpan.textContent = '(Custom)';\n            nameSpan.appendChild(typeSpan);\n        }\n        li.appendChild(nameSpan);\n\n        const removeBtn = document.createElement('button');\n        removeBtn.className = 'remove-btn';\n        removeBtn.textContent = '\u2715';\n        removeBtn.title = 'Remove Tab';\n        removeBtn.addEventListener('click', async () => {\n            await removeTab(tab.id);\n            await renderTabsList();\n        });\n        li.appendChild(removeBtn);\n\n        // Drag Events\n        li.addEventListener('dragstart', handleDragStart);\n        li.addEventListener('dragenter', handleDragEnter);\n        li.addEventListener('dragover', handleDragOver);\n        li.addEventListener('dragleave', handleDragLeave);\n        li.addEventListener('drop', handleDrop);\n        li.addEventListener('dragend', handleDragEnd);\n\n        tabsList.appendChild(li);\n    });\n}\n\n// --- Drag and Drop Logic ---\nlet dragSrcEl: HTMLElement | null = null;\n\nfunction handleDragStart(this: HTMLElement, e: DragEvent) {\n    dragSrcEl = this;\n    this.classList.add('dragging');\n    if (e.dataTransfer) {\n        e.dataTransfer.effectAllowed = 'move';\n        e.dataTransfer.setData('text/plain', this.dataset.index || '');\n    }\n}\n\nfunction handleDragOver(e: DragEvent) {\n    if (e.preventDefault) {\n        e.preventDefault();\n    }\n    if (e.dataTransfer) {\n        e.dataTransfer.dropEffect = 'move';\n    }\n    return false;\n}\n\nfunction handleDragEnter(this: HTMLElement, e: DragEvent) {\n    this.classList.add('over');\n}\n\nfunction handleDragLeave(this: HTMLElement, e: DragEvent) {\n    this.classList.remove('over');\n}\n\nasync function handleDrop(this: HTMLElement, e: DragEvent) {\n    if (e.stopPropagation) {\n        e.stopPropagation();\n    }\n\n    if (dragSrcEl !== this) {\n        const oldIndex = parseInt(dragSrcEl!.dataset.index || '0');\n        const newIndex = parseInt(this.dataset.index || '0');\n\n        const settings = await getSettings();\n        const tabs = [...settings.tabs];\n        const [movedTab] = tabs.splice(oldIndex, 1);\n        tabs.splice(newIndex, 0, movedTab);\n\n        await updateTabOrder(tabs);\n        await renderTabsList();\n    }\n    return false;\n}\n\nfunction handleDragEnd(this: HTMLElement, e: DragEvent) {\n    dragSrcEl = null;\n    document.querySelectorAll('.label-item').forEach(item => {\n        item.classList.remove('over', 'dragging');\n    });\n}\n\n// --- Init ---\ndocument.addEventListener('DOMContentLoaded', () => {\n    initTheme();\n    initTabs();\n});\n"],
  "mappings": "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",
  "names": []
}
