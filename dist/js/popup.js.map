{
  "version": 3,
  "sources": ["../../src/utils/storage.ts", "../../src/popup.ts"],
  "sourcesContent": ["/**\n * storage.ts\n *\n * Helper functions for interacting with chrome.storage.sync.\n * Provides typed access to the extension's settings.\n */\n\nexport interface TabLabel {\n    name: string;\n    id: string; // Unique ID for drag and drop\n    displayName?: string;\n}\n\nexport interface Settings {\n    labels: TabLabel[];\n    theme: 'system' | 'light' | 'dark';\n}\n\nconst DEFAULT_SETTINGS: Settings = {\n    labels: [],\n    theme: 'system'\n};\n\n/**\n * Retrieves the current settings from storage.\n */\nexport async function getSettings(): Promise<Settings> {\n    return new Promise((resolve) => {\n        chrome.storage.sync.get(DEFAULT_SETTINGS, (items) => {\n            resolve(items as Settings);\n        });\n    });\n}\n\n/**\n * Saves the settings to storage.\n * Merges the provided settings with existing ones.\n */\nexport async function saveSettings(newSettings: Partial<Settings>): Promise<void> {\n    const currentSettings = await getSettings();\n    const mergedSettings = { ...currentSettings, ...newSettings };\n    return new Promise((resolve) => {\n        chrome.storage.sync.set(mergedSettings, () => {\n            resolve();\n        });\n    });\n}\n\n/**\n * Adds a new label to the list.\n */\nexport async function addLabel(labelName: string): Promise<void> {\n    const settings = await getSettings();\n    const newLabel: TabLabel = {\n        name: labelName.trim(),\n        id: crypto.randomUUID(),\n        displayName: labelName.trim(),\n    };\n    // Avoid duplicates\n    if (!settings.labels.some((l) => l.name === newLabel.name)) {\n        settings.labels.push(newLabel);\n        await saveSettings(settings);\n    }\n}\n\n/**\n * Removes a label by ID.\n */\nexport async function removeLabel(labelId: string): Promise<void> {\n    const settings = await getSettings();\n    settings.labels = settings.labels.filter((l) => l.id !== labelId);\n    await saveSettings(settings);\n}\n\n/**\n * Updates an existing label.\n */\nexport async function updateLabel(labelId: string, updates: Partial<TabLabel>): Promise<void> {\n    const settings = await getSettings();\n    const index = settings.labels.findIndex((l) => l.id === labelId);\n    if (index !== -1) {\n        settings.labels[index] = { ...settings.labels[index], ...updates };\n        await saveSettings(settings);\n    }\n}\n\n/**\n * Updates the order of labels.\n */\nexport async function updateLabelOrder(newLabels: TabLabel[]): Promise<void> {\n    const settings = await getSettings();\n    settings.labels = newLabels;\n    await saveSettings(settings);\n}\n", "import { getSettings, saveSettings, addLabel, removeLabel, updateLabelOrder, TabLabel } from './utils/storage';\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n    const settings = await getSettings();\n    const themeSelector = document.getElementById('theme-selector');\n    const options = document.querySelectorAll('.theme-option');\n\n    const labelList = document.getElementById('labels-list') as HTMLUListElement;\n    const newLabelInput = document.getElementById('new-label-input') as HTMLInputElement;\n    const addBtn = document.getElementById('add-btn') as HTMLButtonElement;\n    const exportBtn = document.getElementById('export-btn') as HTMLButtonElement;\n    const importBtn = document.getElementById('import-btn') as HTMLButtonElement;\n    const importFile = document.getElementById('import-file') as HTMLInputElement;\n\n    let dragSrcEl: HTMLElement | null = null;\n\n    // --- Theme Logic ---\n    // Set initial state\n    updateActiveOption(settings.theme);\n\n    themeSelector?.addEventListener('click', async (e) => {\n        const target = e.target as HTMLElement;\n        if (target.classList.contains('theme-option')) {\n            const value = target.dataset.value as 'system' | 'light' | 'dark';\n            updateActiveOption(value);\n            await saveSettings({ theme: value });\n        }\n    });\n\n    function updateActiveOption(value: string) {\n        options.forEach(opt => {\n            if ((opt as HTMLElement).dataset.value === value) {\n                opt.classList.add('active');\n            } else {\n                opt.classList.remove('active');\n            }\n        });\n    }\n\n    // --- Tab Management Logic ---\n    renderList();\n\n    async function renderList() {\n        const currentSettings = await getSettings();\n        labelList.innerHTML = '';\n\n        if (currentSettings.labels.length === 0) {\n            labelList.innerHTML = '<li style=\"padding:10px; text-align:center; color:#888; font-size:12px;\">No tabs added yet.</li>';\n            return;\n        }\n\n        currentSettings.labels.forEach((label, index) => {\n            const li = document.createElement('li');\n            li.className = 'label-item';\n            li.setAttribute('draggable', 'true');\n            li.dataset.index = index.toString();\n            li.innerHTML = `\n                <div class=\"drag-handle\" title=\"Drag to reorder\">\n                    <svg viewBox=\"0 0 24 24\"><path d=\"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"/></svg>\n                </div>\n                <span class=\"label-name\" title=\"${label.displayName || label.name}\">${label.displayName || label.name}</span>\n                <button class=\"remove-btn\" data-id=\"${label.id}\">\u00D7</button>\n            `;\n\n            // Drag Events\n            li.addEventListener('dragstart', handleDragStart);\n            li.addEventListener('dragenter', handleDragEnter);\n            li.addEventListener('dragover', handleDragOver);\n            li.addEventListener('dragleave', handleDragLeave);\n            li.addEventListener('drop', handleDrop);\n            li.addEventListener('dragend', handleDragEnd);\n\n            labelList.appendChild(li);\n        });\n\n        // Add remove listeners\n        document.querySelectorAll('.remove-btn').forEach((btn) => {\n            btn.addEventListener('click', async (e) => {\n                const id = (e.target as HTMLElement).dataset.id;\n                if (id) {\n                    await removeLabel(id);\n                    renderList();\n                }\n            });\n        });\n    }\n\n    // Drag Handlers\n    function handleDragStart(e: DragEvent) {\n        dragSrcEl = e.target as HTMLElement;\n        (e.target as HTMLElement).classList.add('dragging');\n        e.dataTransfer!.effectAllowed = 'move';\n        // Store index\n        e.dataTransfer!.setData('text/plain', (e.target as HTMLElement).dataset.index || '');\n    }\n\n    function handleDragOver(e: DragEvent) {\n        if (e.preventDefault) {\n            e.preventDefault(); // Necessary. Allows us to drop.\n        }\n        e.dataTransfer!.dropEffect = 'move';\n        return false;\n    }\n\n    function handleDragEnter(e: DragEvent) {\n        (e.target as HTMLElement).closest('.label-item')?.classList.add('over');\n    }\n\n    function handleDragLeave(e: DragEvent) {\n        (e.target as HTMLElement).closest('.label-item')?.classList.remove('over');\n    }\n\n    async function handleDrop(e: DragEvent) {\n        if (e.stopPropagation) {\n            e.stopPropagation(); // stops the browser from redirecting.\n        }\n\n        const dropTarget = (e.target as HTMLElement).closest('.label-item') as HTMLElement;\n        if (dragSrcEl !== dropTarget && dropTarget) {\n            const oldIndex = parseInt(dragSrcEl!.dataset.index || '0');\n            const newIndex = parseInt(dropTarget.dataset.index || '0');\n\n            // Reorder\n            const s = await getSettings();\n            const labels = [...s.labels];\n            const [movedLabel] = labels.splice(oldIndex, 1);\n            labels.splice(newIndex, 0, movedLabel);\n\n            await updateLabelOrder(labels);\n            renderList();\n        }\n        return false;\n    }\n\n    function handleDragEnd(e: DragEvent) {\n        dragSrcEl = null;\n        document.querySelectorAll('.label-item').forEach(item => {\n            item.classList.remove('over', 'dragging');\n        });\n    }\n\n    // Add Label\n    addBtn.addEventListener('click', async () => {\n        const name = newLabelInput.value;\n        if (name) {\n            await addLabel(name);\n            newLabelInput.value = '';\n            renderList();\n        }\n    });\n\n    newLabelInput.addEventListener('keypress', async (e) => {\n        if (e.key === 'Enter') {\n            const name = newLabelInput.value;\n            if (name) {\n                await addLabel(name);\n                newLabelInput.value = '';\n                renderList();\n            }\n        }\n    });\n\n    // Export JSON\n    exportBtn.addEventListener('click', async () => {\n        const s = await getSettings();\n        const dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(s.labels, null, 2));\n        const downloadAnchorNode = document.createElement('a');\n        downloadAnchorNode.setAttribute(\"href\", dataStr);\n        downloadAnchorNode.setAttribute(\"download\", \"gmail_tabs_config.json\");\n        document.body.appendChild(downloadAnchorNode);\n        downloadAnchorNode.click();\n        downloadAnchorNode.remove();\n    });\n\n    // Import JSON\n    importBtn.addEventListener('click', () => {\n        importFile.click();\n    });\n\n    importFile.addEventListener('change', (event) => {\n        const file = (event.target as HTMLInputElement).files?.[0];\n        if (!file) return;\n\n        const reader = new FileReader();\n        reader.onload = async (e) => {\n            try {\n                const content = e.target?.result as string;\n                const labels = JSON.parse(content) as TabLabel[];\n                if (Array.isArray(labels)) {\n                    await saveSettings({ labels });\n                    renderList();\n                    alert('Tabs imported successfully!');\n                } else {\n                    alert('Invalid JSON format.');\n                }\n            } catch (err) {\n                alert('Error parsing JSON.');\n            }\n        };\n        reader.readAsText(file);\n    });\n});\n"],
  "mappings": "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",
  "names": []
}
