{
  "version": 3,
  "sources": ["../../src/utils/storage.ts", "../../src/content.ts"],
  "sourcesContent": ["/**\n * storage.ts\n *\n * Helper functions for interacting with chrome.storage.sync.\n * Provides typed access to the extension's settings.\n */\n\nexport interface Tab {\n    id: string;\n    title: string;       // Display Name\n    type: 'label' | 'hash'; // 'label' for legacy/simple, 'hash' for custom views\n    value: string;       // The label name or full hash string\n}\n\n// Legacy interface for migration\ninterface LegacyTabLabel {\n    name: string;\n    id: string;\n    displayName?: string;\n}\n\nexport interface Settings {\n    tabs: Tab[];\n    // Legacy support for migration\n    labels?: LegacyTabLabel[];\n    theme: 'system' | 'light' | 'dark';\n}\n\nconst DEFAULT_SETTINGS: Settings = {\n    tabs: [],\n    theme: 'system'\n};\n\n/**\n * Retrieves the current settings from storage.\n * Handles migration from legacy 'labels' to 'tabs'.\n */\nexport async function getSettings(): Promise<Settings> {\n    return new Promise((resolve) => {\n        chrome.storage.sync.get(null, (items) => { // Get all items to check for legacy 'labels'\n            const settings = { ...DEFAULT_SETTINGS, ...items } as Settings;\n\n            // Migration Logic: If 'labels' exists but 'tabs' is empty/missing\n            if (settings.labels && settings.labels.length > 0 && (!settings.tabs || settings.tabs.length === 0)) {\n                console.log('Migrating legacy labels to tabs...');\n                settings.tabs = settings.labels.map(l => ({\n                    id: l.id,\n                    title: l.displayName || l.name,\n                    type: 'label',\n                    value: l.name\n                }));\n                // Clear legacy labels to prevent re-migration\n                delete settings.labels;\n                // Save migrated settings immediately\n                chrome.storage.sync.set(settings);\n            }\n\n            resolve(settings);\n        });\n    });\n}\n\n/**\n * Saves the settings to storage.\n * Merges the provided settings with existing ones.\n */\nexport async function saveSettings(newSettings: Partial<Settings>): Promise<void> {\n    const currentSettings = await getSettings();\n    const mergedSettings = { ...currentSettings, ...newSettings };\n    return new Promise((resolve) => {\n        chrome.storage.sync.set(mergedSettings, () => {\n            resolve();\n        });\n    });\n}\n\n/**\n * Adds a new tab to the list.\n */\nexport async function addTab(title: string, value: string, type: 'label' | 'hash' = 'label'): Promise<void> {\n    const settings = await getSettings();\n    const newTab: Tab = {\n        id: crypto.randomUUID(),\n        title: title.trim(),\n        value: value.trim(),\n        type: type\n    };\n\n    // Avoid duplicates based on value\n    if (!settings.tabs.some((t) => t.value === newTab.value)) {\n        settings.tabs.push(newTab);\n        await saveSettings(settings);\n    }\n}\n\n/**\n * Removes a tab by ID.\n */\nexport async function removeTab(tabId: string): Promise<void> {\n    const settings = await getSettings();\n    settings.tabs = settings.tabs.filter((t) => t.id !== tabId);\n    await saveSettings(settings);\n}\n\n/**\n * Updates an existing tab.\n */\nexport async function updateTab(tabId: string, updates: Partial<Tab>): Promise<void> {\n    const settings = await getSettings();\n    const index = settings.tabs.findIndex((t) => t.id === tabId);\n    if (index !== -1) {\n        settings.tabs[index] = { ...settings.tabs[index], ...updates };\n        await saveSettings(settings);\n    }\n}\n\n/**\n * Updates the order of tabs.\n */\nexport async function updateTabOrder(newTabs: Tab[]): Promise<void> {\n    const settings = await getSettings();\n    settings.tabs = newTabs;\n    await saveSettings(settings);\n}\n", "/**\n * content.ts\n *\n * Main content script for Gmail Labels as Tabs.\n * Handles DOM injection, navigation monitoring, and tab rendering.\n */\n\nimport { getSettings, saveSettings, addTab, removeTab, updateTabOrder, updateTab, Settings, Tab } from './utils/storage';\n\n// Start the dropdown observer\n// initLabelDropdownObserver(); // Removed duplicate call\n\n// Selectors for Gmail elements\n// We target the main toolbar container to inject below it.\nconst TOOLBAR_SELECTORS = [\n    '.G-atb', // Main toolbar container (often has this class)\n    '.aeF > div:first-child', // Fallback\n];\n\nconst TABS_BAR_ID = 'gmail-labels-as-tabs-bar';\nconst MODAL_ID = 'gmail-labels-settings-modal';\n\nlet currentSettings: Settings | null = null;\nlet observer: MutationObserver | null = null;\n\n/**\n * Initialize the extension.\n */\nasync function init() {\n    currentSettings = await getSettings();\n\n    // Listen for storage changes to update tabs in real-time\n    chrome.storage.onChanged.addListener((changes, area) => {\n        if (area === 'sync') {\n            if (changes.tabs) {\n                currentSettings!.tabs = changes.tabs.newValue;\n                renderTabs();\n            }\n            if (changes.theme) {\n                currentSettings!.theme = changes.theme.newValue;\n                applyTheme(currentSettings!.theme);\n            }\n        }\n    });\n\n    // Initial render attempt\n    attemptInjection();\n\n    // Start observing DOM for navigation/loading\n    startObserver();\n\n    // Listen for URL changes (popstate)\n    window.addEventListener('popstate', handleUrlChange);\n\n    // Listen for messages from background script\n    chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n        if (message.action === 'TOGGLE_SETTINGS') {\n            toggleSettingsModal();\n        }\n    });\n}\n\n/**\n * Attempt to inject the tabs bar.\n * Retries if the insertion point isn't found yet.\n */\nfunction attemptInjection() {\n    // If bar exists, check if it's in the right place (top)\n    const existingBar = document.getElementById(TABS_BAR_ID);\n\n    let injectionPoint: Element | null = null;\n    for (const selector of TOOLBAR_SELECTORS) {\n        // We want the visible toolbar\n        const candidates = document.querySelectorAll(selector);\n        for (const el of candidates) {\n            if (el.getBoundingClientRect().height > 0) {\n                injectionPoint = el;\n                break;\n            }\n        }\n        if (injectionPoint) break;\n    }\n\n    if (injectionPoint) {\n        if (!existingBar) {\n            const tabsBar = createTabsBar();\n            injectionPoint.insertAdjacentElement('afterend', tabsBar);\n            renderTabs();\n        } else if (existingBar.previousElementSibling !== injectionPoint) {\n            // Re-attach if moved\n            injectionPoint.insertAdjacentElement('afterend', existingBar);\n        }\n        updateActiveTab();\n    } else {\n        // Retry shortly if not found (Gmail loading)\n        setTimeout(attemptInjection, 500);\n    }\n}\n\n/**\n * Create the container for the tabs.\n */\nfunction createTabsBar(): HTMLElement {\n    const bar = document.createElement('div');\n    bar.id = TABS_BAR_ID;\n    bar.className = 'gmail-tabs-bar';\n    return bar;\n}\n\n/**\n * Render the tabs based on current settings.\n */\n\n// --- Drag Handlers ---\nlet dragSrcEl: HTMLElement | null = null;\n\nfunction handleDragStart(this: HTMLElement, e: DragEvent) {\n    dragSrcEl = this;\n    this.classList.add('dragging');\n    if (e.dataTransfer) {\n        e.dataTransfer.effectAllowed = 'move';\n        e.dataTransfer.setData('text/plain', this.dataset.index || '');\n        // Set a transparent drag image if possible, or let browser handle it\n    }\n}\n\nfunction handleDragOver(e: DragEvent) {\n    if (e.preventDefault) {\n        e.preventDefault();\n    }\n    if (e.dataTransfer) {\n        e.dataTransfer.dropEffect = 'move';\n    }\n    return false;\n}\n\nfunction handleDragEnter(this: HTMLElement, e: DragEvent) {\n    this.classList.add('drag-over');\n}\n\nfunction handleDragLeave(this: HTMLElement, e: DragEvent) {\n    // Prevent flickering when entering child elements\n    if (this.contains(e.relatedTarget as Node)) return;\n    this.classList.remove('drag-over');\n}\n\nasync function handleDrop(this: HTMLElement, e: DragEvent) {\n    if (e.stopPropagation) {\n        e.stopPropagation();\n    }\n\n    // Remove the drop marker\n    this.classList.remove('drag-over');\n\n    if (dragSrcEl !== this) {\n        const oldIndex = parseInt(dragSrcEl!.dataset.index || '0');\n        const newIndex = parseInt(this.dataset.index || '0');\n\n        // Optimistic update\n        if (currentSettings) {\n            const tabs = [...currentSettings.tabs];\n            const [movedTab] = tabs.splice(oldIndex, 1);\n            tabs.splice(newIndex, 0, movedTab);\n\n            // Update local state immediately\n            currentSettings.tabs = tabs;\n            renderTabs();\n\n            // Persist\n            await updateTabOrder(tabs);\n        }\n    }\n    return false;\n}\n\nfunction handleDragEnd(this: HTMLElement, e: DragEvent) {\n    dragSrcEl = null;\n    document.querySelectorAll('.gmail-tab').forEach(item => {\n        item.classList.remove('drag-over', 'dragging');\n    });\n}\n\nfunction renderTabs() {\n    const bar = document.getElementById(TABS_BAR_ID);\n    if (!bar || !currentSettings) return;\n    bar.innerHTML = '';\n\n    currentSettings.tabs.forEach((tab, index) => {\n        const tabEl = document.createElement('div');\n        tabEl.className = 'gmail-tab';\n        tabEl.setAttribute('draggable', 'true');\n        tabEl.dataset.index = index.toString();\n        tabEl.dataset.value = tab.value;\n        tabEl.dataset.type = tab.type;\n\n        // Drag Handle\n        const dragHandle = document.createElement('div');\n        dragHandle.className = 'tab-drag-handle';\n        dragHandle.title = 'Drag to reorder';\n        dragHandle.innerHTML = '<svg viewBox=\"0 0 24 24\"><path d=\"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"/></svg>';\n        tabEl.appendChild(dragHandle);\n\n        const nameSpan = document.createElement('span');\n        nameSpan.className = 'tab-name';\n        nameSpan.textContent = tab.title;\n        tabEl.appendChild(nameSpan);\n\n        const actions = document.createElement('div');\n        actions.className = 'tab-actions';\n\n        const editBtn = document.createElement('div');\n        editBtn.className = 'tab-action-btn edit-btn';\n        editBtn.innerHTML = '\u22EE';\n        editBtn.title = 'Edit Tab';\n        editBtn.addEventListener('click', (e) => {\n            e.stopPropagation();\n            showEditModal(tab);\n        });\n        actions.appendChild(editBtn);\n\n        const deleteBtn = document.createElement('div');\n        deleteBtn.className = 'tab-action-btn delete-btn';\n        deleteBtn.innerHTML = '\u2715';\n        deleteBtn.title = 'Remove Tab';\n        deleteBtn.addEventListener('click', async (e) => {\n            e.stopPropagation();\n            if (confirm(`Remove tab \"${tab.title}\"?`)) {\n                await removeTab(tab.id);\n                currentSettings = await getSettings();\n                renderTabs();\n            }\n        });\n        actions.appendChild(deleteBtn);\n        tabEl.appendChild(actions);\n\n        tabEl.addEventListener('click', (e) => {\n            // Don't navigate if clicking actions or drag handle\n            if ((e.target as HTMLElement).closest('.tab-actions') || (e.target as HTMLElement).closest('.tab-drag-handle')) {\n                return;\n            }\n\n            if (tab.type === 'hash') {\n                window.location.hash = tab.value;\n            } else {\n                window.location.href = getLabelUrl(tab.value);\n            }\n        });\n\n        // Drag Events\n        tabEl.addEventListener('dragend', handleDragEnd);\n\n        bar.appendChild(tabEl);\n    });\n\n    // \"Save View\" Button (formerly Pin, now Plus)\n    const saveViewBtn = document.createElement('div');\n    saveViewBtn.className = 'gmail-tab-btn save-view-btn';\n    // Google Material Symbol: add_circle (outlined)\n    saveViewBtn.innerHTML = '<svg viewBox=\"0 0 24 24\"><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z\"/></svg>';\n    saveViewBtn.title = 'Save Current View as Tab';\n    saveViewBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        showPinModal();\n    });\n    bar.appendChild(saveViewBtn);\n\n    // \"Manage Tabs\" Button (formerly Add, now Pencil)\n    const manageBtn = document.createElement('div');\n    manageBtn.className = 'gmail-tab-btn manage-btn';\n    // Google Material Symbol: edit\n    manageBtn.innerHTML = '<svg viewBox=\"0 0 24 24\"><path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"/></svg>';\n    manageBtn.title = 'Manage Tabs';\n    manageBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        toggleSettingsModal();\n    });\n    bar.appendChild(manageBtn);\n\n    updateActiveTab();\n}\n\n// --- Pin Modal ---\nfunction showPinModal() {\n    const currentHash = window.location.hash;\n    if (!currentHash || currentHash === '#inbox') {\n        alert('Cannot pin the Inbox. Navigate to a label or search first.');\n        return;\n    }\n\n    const modal = document.createElement('div');\n    modal.className = 'gmail-tabs-modal';\n\n    // Suggest a title based on the hash\n    let suggestedTitle = 'New Tab';\n    if (currentHash.startsWith('#label/')) {\n        suggestedTitle = decodeURIComponent(currentHash.replace('#label/', '')).replace(/\\+/g, ' ');\n    } else if (currentHash.startsWith('#search/')) {\n        suggestedTitle = 'Search: ' + decodeURIComponent(currentHash.replace('#search/', '')).replace(/\\+/g, ' ');\n    } else if (currentHash.startsWith('#advanced-search/')) {\n        suggestedTitle = 'Advanced Search';\n    }\n\n    modal.innerHTML = `\n        <div class=\"modal-content edit-tab-modal\">\n            <div class=\"modal-header\">\n                <h3>Pin Current View</h3>\n                <button class=\"close-btn\">\u2715</button>\n            </div>\n            <div class=\"modal-body\">\n                <div class=\"form-group\">\n                    <label>View URL (Hash):</label>\n                    <input type=\"text\" value=\"${currentHash}\" disabled class=\"disabled-input\">\n                </div>\n                <div class=\"form-group\">\n                    <label>Tab Title:</label>\n                    <input type=\"text\" id=\"pin-title\" value=\"${suggestedTitle}\">\n                </div>\n                <div class=\"modal-actions\">\n                    <button id=\"pin-save-btn\" class=\"primary-btn\">Pin Tab</button>\n                </div>\n            </div>\n        </div>\n    `;\n\n    document.body.appendChild(modal);\n\n    const close = () => modal.remove();\n    modal.querySelector('.close-btn')?.addEventListener('click', close);\n    modal.addEventListener('click', (e) => {\n        if (e.target === modal) close();\n    });\n\n    modal.querySelector('#pin-save-btn')?.addEventListener('click', async () => {\n        const title = (modal.querySelector('#pin-title') as HTMLInputElement).value;\n\n        if (title) {\n            await addTab(title, currentHash, 'hash');\n            close();\n            // Refresh settings and re-render\n            currentSettings = await getSettings();\n            renderTabs();\n        }\n    });\n}\n\n// --- Edit Modal ---\nfunction showEditModal(tab: Tab) {\n    const modal = document.createElement('div');\n    modal.className = 'gmail-tabs-modal';\n\n    modal.innerHTML = `\n        <div class=\"modal-content edit-tab-modal\">\n            <div class=\"modal-header\">\n                <h3>Edit Tab</h3>\n                <button class=\"close-btn\">\u2715</button>\n            </div>\n            <div class=\"modal-body\">\n                <div class=\"form-group\">\n                    <label>Value (${tab.type}):</label>\n                    <input type=\"text\" value=\"${tab.value}\" disabled class=\"disabled-input\">\n                </div>\n                <div class=\"form-group\">\n                    <label>Display Name:</label>\n                    <input type=\"text\" id=\"edit-display-name\" value=\"${tab.title}\">\n                </div>\n                <div class=\"modal-actions\">\n                    <button id=\"edit-save-btn\" class=\"primary-btn\">Save</button>\n                </div>\n            </div>\n        </div>\n    `;\n\n    document.body.appendChild(modal);\n\n    const close = () => modal.remove();\n    modal.querySelector('.close-btn')?.addEventListener('click', close);\n    modal.addEventListener('click', (e) => {\n        if (e.target === modal) close();\n    });\n\n    modal.querySelector('#edit-save-btn')?.addEventListener('click', async () => {\n        const title = (modal.querySelector('#edit-display-name') as HTMLInputElement).value;\n\n        if (title) {\n            await updateTab(tab.id, {\n                title: title.trim()\n            });\n\n            close();\n            // Refresh settings and re-render\n            currentSettings = await getSettings();\n            renderTabs();\n        }\n    });\n}\n\n/**\n * Generate the URL for a given label.\n */\nfunction getLabelUrl(labelName: string): string {\n    const encoded = encodeURIComponent(labelName).replace(/%20/g, '+');\n    return `https://mail.google.com/mail/u/0/#label/${encoded}`;\n}\n\n/**\n * Highlight the active tab based on current URL.\n */\nfunction updateActiveTab() {\n    const hash = window.location.hash;\n    const bar = document.getElementById(TABS_BAR_ID);\n    if (!bar) return;\n\n    const tabs = bar.querySelectorAll('.gmail-tab');\n    tabs.forEach(t => {\n        const tabEl = t as HTMLElement;\n        const tabValue = tabEl.dataset.value;\n        const tabType = tabEl.dataset.type;\n        if (!tabValue) return;\n\n        let isActive = false;\n\n        if (tabType === 'hash') {\n            // Exact match for hash tabs\n            isActive = hash === tabValue;\n        } else {\n            // Label matching logic\n            const cleanHash = decodeURIComponent(hash.replace('#label/', '').replace(/\\+/g, ' '));\n            isActive = cleanHash === tabValue || hash.includes(`#label/${encodeURIComponent(tabValue).replace(/%20/g, '+')}`);\n        }\n\n        if (isActive) {\n            tabEl.classList.add('active');\n        } else {\n            tabEl.classList.remove('active');\n        }\n    });\n}\n\nfunction handleUrlChange() {\n    updateActiveTab();\n}\n\nfunction startObserver() {\n    if (observer) observer.disconnect();\n\n    observer = new MutationObserver((mutations) => {\n        attemptInjection();\n        updateActiveTab();\n    });\n\n    observer.observe(document.body, {\n        childList: true,\n        subtree: true,\n    });\n}\n\n// --- Settings Modal Logic ---\n\nfunction toggleSettingsModal() {\n    let modal = document.getElementById(MODAL_ID);\n    if (modal) {\n        modal.remove();\n    } else {\n        createSettingsModal();\n    }\n}\n\nfunction createSettingsModal() {\n    const modal = document.createElement('div');\n    modal.id = MODAL_ID;\n    modal.className = 'gmail-tabs-modal';\n\n    modal.innerHTML = `\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3>Configure Tabs</h3>\n                <button class=\"close-btn\">\u2715</button>\n            </div>\n            <div class=\"modal-body\">\n                <div class=\"form-group theme-selector-group\">\n                    <label>Theme</label>\n                    <div class=\"theme-options\">\n                        <button class=\"theme-btn\" data-theme=\"system\">System</button>\n                        <button class=\"theme-btn\" data-theme=\"light\">Light</button>\n                        <button class=\"theme-btn\" data-theme=\"dark\">Dark</button>\n                    </div>\n                </div>\n                <div style=\"border-bottom: 1px solid var(--list-border); margin-bottom: 16px;\"></div>\n                \n                <div class=\"add-tab-section\">\n                    <div class=\"input-group\">\n                        <input type=\"text\" id=\"modal-new-label\" placeholder=\"Label Name or View URL\">\n                    </div>\n                    <div id=\"modal-error-msg\" class=\"input-error-msg\" style=\"display: none;\"></div>\n                    <div class=\"input-group\" id=\"modal-title-group\" style=\"display:none;\">\n                        <input type=\"text\" id=\"modal-new-title\" placeholder=\"Tab Title\">\n                    </div>\n                    <button id=\"modal-add-btn\" class=\"primary-btn\" style=\"width: 100%; margin-bottom: 16px;\">Add Tab</button>\n                </div>\n                <div style=\"border-bottom: 1px solid var(--list-border); margin-bottom: 16px;\"></div>\n                <ul id=\"modal-labels-list\"></ul>\n            </div>\n        </div>\n    `;\n\n    document.body.appendChild(modal);\n\n    // Event Listeners\n    modal.querySelector('.close-btn')?.addEventListener('click', () => modal.remove());\n    modal.addEventListener('click', (e) => {\n        if (e.target === modal) modal.remove();\n    });\n\n    const addBtn = modal.querySelector('#modal-add-btn') as HTMLButtonElement;\n    const input = modal.querySelector('#modal-new-label') as HTMLInputElement;\n    const titleInput = modal.querySelector('#modal-new-title') as HTMLInputElement;\n    const titleGroup = modal.querySelector('#modal-title-group') as HTMLElement;\n    const list = modal.querySelector('#modal-labels-list') as HTMLUListElement;\n\n    // Smart Input Detection\n    input.addEventListener('input', () => {\n        const value = input.value.trim();\n        const isUrl = value.includes('http') || value.includes('mail.google.com') || value.startsWith('#');\n\n        if (isUrl) {\n            titleGroup.style.display = 'flex';\n            // Auto-extract title if possible (simple heuristic)\n            if (!titleInput.value) {\n                if (value.includes('#search/')) {\n                    titleInput.value = decodeURIComponent(value.split('#search/')[1]).replace(/\\+/g, ' ');\n                } else if (value.includes('#label/')) {\n                    titleInput.value = decodeURIComponent(value.split('#label/')[1]).replace(/\\+/g, ' ');\n                }\n            }\n        } else {\n            // For simple labels, we can hide the title input or keep it optional.\n            // Let's hide it to keep it simple, unless user manually opened it? \n            // For now, auto-hide if it goes back to simple text and title is empty.\n            if (!titleInput.value) {\n                titleGroup.style.display = 'none';\n            }\n        }\n    });\n\n    // Modal Drag and Drop Logic\n    let modalDragSrcEl: HTMLElement | null = null;\n\n    const handleModalDragStart = function (this: HTMLElement, e: DragEvent) {\n        modalDragSrcEl = this;\n        this.classList.add('dragging');\n        if (e.dataTransfer) {\n            e.dataTransfer.effectAllowed = 'move';\n            e.dataTransfer.setData('text/plain', this.dataset.index || '');\n        }\n    };\n\n    const handleModalDragOver = function (this: HTMLElement, e: DragEvent) {\n        if (e.preventDefault) {\n            e.preventDefault();\n        }\n        if (e.dataTransfer) {\n            e.dataTransfer.dropEffect = 'move';\n        }\n\n        // Calculate position within the element\n        const rect = this.getBoundingClientRect();\n        const relY = e.clientY - rect.top;\n        const height = rect.height;\n\n        // Remove existing classes first\n        this.classList.remove('drop-above', 'drop-below');\n\n        if (relY < height / 2) {\n            this.classList.add('drop-above');\n        } else {\n            this.classList.add('drop-below');\n        }\n\n        return false;\n    };\n\n    const handleModalDragEnter = function (this: HTMLElement) {\n        this.classList.add('drag-over');\n    };\n\n    const handleModalDragLeave = function (this: HTMLElement) {\n        this.classList.remove('drag-over', 'drop-above', 'drop-below');\n    };\n\n    const handleModalDrop = async function (this: HTMLElement, e: DragEvent) {\n        if (e.stopPropagation) {\n            e.stopPropagation();\n        }\n\n        const dropPosition = this.classList.contains('drop-above') ? 'above' : 'below';\n        this.classList.remove('drag-over', 'drop-above', 'drop-below');\n\n        if (modalDragSrcEl !== this) {\n            const oldIndex = parseInt(modalDragSrcEl!.dataset.index || '0');\n            let newIndex = parseInt(this.dataset.index || '0');\n\n            // Adjust newIndex based on drop position\n            if (dropPosition === 'below') {\n                newIndex++;\n            }\n\n            // If moving down, the index shifts because we remove the item first\n            // But if we are inserting 'below' a target that is essentially at index+1\n            // Let's simplify: remove first, then insert.\n\n            const settings = await getSettings();\n            const newTabs = [...settings.tabs];\n            const [movedTab] = newTabs.splice(oldIndex, 1);\n\n            // If we removed an item from before the target, the target's index shifted down by 1\n            if (oldIndex < newIndex) {\n                newIndex--;\n            }\n\n            newTabs.splice(newIndex, 0, movedTab);\n\n            await updateTabOrder(newTabs);\n            refreshList();\n            // Also update the main bar\n            currentSettings = await getSettings();\n            renderTabs();\n        }\n        return false;\n    };\n\n    const handleModalDragEnd = function (this: HTMLElement) {\n        modalDragSrcEl = null;\n        list.querySelectorAll('li').forEach(item => {\n            item.classList.remove('drag-over', 'dragging', 'drop-above', 'drop-below');\n        });\n    };\n\n    const refreshList = async () => {\n        const settings = await getSettings();\n        list.innerHTML = '';\n        settings.tabs.forEach((tab, index) => {\n            const li = document.createElement('li');\n            li.setAttribute('draggable', 'true');\n            li.dataset.index = index.toString();\n\n            li.innerHTML = `\n                <div class=\"modal-drag-handle\" title=\"Drag to reorder\">\n                    <svg viewBox=\"0 0 24 24\"><path d=\"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"/></svg>\n                </div>\n                <span class=\"tab-info\">${tab.title} <small style=\"color: #888; font-size: 0.8em;\">(${tab.type === 'hash' ? 'Custom' : 'Label'})</small></span>\n                <div class=\"actions\">\n                    ${index > 0 ? '<button class=\"up-btn\">\u2191</button>' : ''}\n                    ${index < settings.tabs.length - 1 ? '<button class=\"down-btn\">\u2193</button>' : ''}\n                    <button class=\"remove-btn\">\u2715</button>\n                </div>\n            `;\n\n            li.querySelector('.remove-btn')?.addEventListener('click', async () => {\n                await removeTab(tab.id);\n                refreshList();\n                currentSettings = await getSettings();\n                renderTabs();\n            });\n\n            li.querySelector('.up-btn')?.addEventListener('click', async () => {\n                const newTabs = [...settings.tabs];\n                [newTabs[index - 1], newTabs[index]] = [newTabs[index], newTabs[index - 1]];\n                await updateTabOrder(newTabs);\n                refreshList();\n                currentSettings = await getSettings();\n                renderTabs();\n            });\n\n            li.querySelector('.down-btn')?.addEventListener('click', async () => {\n                const newTabs = [...settings.tabs];\n                [newTabs[index + 1], newTabs[index]] = [newTabs[index], newTabs[index + 1]];\n                await updateTabOrder(newTabs);\n                refreshList();\n                currentSettings = await getSettings();\n                renderTabs();\n            });\n\n            // Add Drag Listeners\n            li.addEventListener('dragstart', handleModalDragStart);\n            li.addEventListener('dragover', handleModalDragOver);\n            li.addEventListener('dragenter', handleModalDragEnter);\n            li.addEventListener('dragleave', handleModalDragLeave);\n            li.addEventListener('drop', handleModalDrop);\n            li.addEventListener('dragend', handleModalDragEnd);\n\n            list.appendChild(li);\n        });\n    };\n\n    const errorMsg = modal.querySelector('#modal-error-msg') as HTMLElement;\n\n    // Clear error on input\n    input.addEventListener('input', () => {\n        input.classList.remove('input-error');\n        errorMsg.style.display = 'none';\n        // ... existing input logic ...\n    });\n\n    addBtn.addEventListener('click', async () => {\n        let value = input.value.trim();\n        let title = titleInput.value.trim();\n\n        if (value) {\n            // Check if it's a URL/Hash\n            let type: 'label' | 'hash' = 'label';\n            let finalValue = value;\n\n            if (value.includes('http') || value.includes('mail.google.com') || value.startsWith('#')) {\n                type = 'hash';\n                // Extract Hash\n                if (value.includes('#')) {\n                    finalValue = '#' + value.split('#')[1];\n                }\n            } else {\n                // It's a Label\n                if (value.toLowerCase().startsWith('label:')) {\n                    finalValue = value.substring(6).trim();\n                }\n            }\n\n            // Duplicate Check\n            const settings = await getSettings();\n            const existingTab = settings.tabs.find(t => t.value === finalValue);\n\n            if (existingTab) {\n                input.classList.add('input-error');\n                errorMsg.textContent = `View URL / Label already exists with tab display name as \"${existingTab.title}\"`;\n                errorMsg.style.display = 'block';\n                return;\n            }\n\n            if (type === 'hash') {\n                if (!title) {\n                    alert('Please enter a Title for this tab.');\n                    titleInput.focus();\n                    return;\n                }\n                await addTab(title, finalValue, 'hash');\n            } else {\n                await addTab(title || finalValue, finalValue, 'label');\n            }\n\n            input.value = '';\n            titleInput.value = '';\n            titleGroup.style.display = 'none';\n            input.classList.remove('input-error');\n            errorMsg.style.display = 'none';\n\n            refreshList();\n            // Also update the main bar\n            currentSettings = await getSettings();\n            renderTabs();\n        }\n    });\n\n    refreshList();\n\n    // Theme Selector Logic\n    const themeBtns = modal.querySelectorAll('.theme-btn');\n    const updateThemeUI = (activeTheme: string) => {\n        themeBtns.forEach(btn => {\n            if ((btn as HTMLElement).dataset.theme === activeTheme) {\n                btn.classList.add('active');\n            } else {\n                btn.classList.remove('active');\n            }\n        });\n    };\n\n    // Initialize UI\n    getSettings().then(settings => {\n        updateThemeUI(settings.theme);\n    });\n\n    themeBtns.forEach(btn => {\n        btn.addEventListener('click', async () => {\n            const theme = (btn as HTMLElement).dataset.theme as 'system' | 'light' | 'dark';\n            await saveSettings({ theme });\n            updateThemeUI(theme);\n            applyTheme(theme);\n            // currentSettings will be updated via storage listener\n        });\n    });\n}\n\n// Run init\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', init);\n} else {\n    init();\n}\n\n// --- Theme Management ---\nfunction applyTheme(theme: 'system' | 'light' | 'dark') {\n    document.body.classList.remove('force-dark', 'force-light');\n\n    if (theme === 'dark') {\n        document.body.classList.add('force-dark');\n    } else if (theme === 'light') {\n        document.body.classList.add('force-light');\n    }\n    // 'system' does nothing, letting media queries handle it\n}\n\n// Initial Theme Application\nif (currentSettings) {\n    applyTheme(currentSettings.theme);\n} else {\n    getSettings().then(settings => applyTheme(settings.theme));\n}\n"],
  "mappings": "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",
  "names": ["currentSettings"]
}
