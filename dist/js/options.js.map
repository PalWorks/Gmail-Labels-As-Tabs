{
  "version": 3,
  "sources": ["../../src/utils/storage.ts", "../../src/options.ts"],
  "sourcesContent": ["/**\n * storage.ts\n *\n * Helper functions for interacting with chrome.storage.sync.\n * Provides typed access to the extension's settings.\n */\n\nexport interface TabLabel {\n    name: string;\n    id: string; // Unique ID for drag and drop\n    displayName?: string;\n}\n\nexport interface Settings {\n    labels: TabLabel[];\n    theme: 'system' | 'light' | 'dark';\n}\n\nconst DEFAULT_SETTINGS: Settings = {\n    labels: [],\n    theme: 'system'\n};\n\n/**\n * Retrieves the current settings from storage.\n */\nexport async function getSettings(): Promise<Settings> {\n    return new Promise((resolve) => {\n        chrome.storage.sync.get(DEFAULT_SETTINGS, (items) => {\n            resolve(items as Settings);\n        });\n    });\n}\n\n/**\n * Saves the settings to storage.\n * Merges the provided settings with existing ones.\n */\nexport async function saveSettings(newSettings: Partial<Settings>): Promise<void> {\n    const currentSettings = await getSettings();\n    const mergedSettings = { ...currentSettings, ...newSettings };\n    return new Promise((resolve) => {\n        chrome.storage.sync.set(mergedSettings, () => {\n            resolve();\n        });\n    });\n}\n\n/**\n * Adds a new label to the list.\n */\nexport async function addLabel(labelName: string): Promise<void> {\n    const settings = await getSettings();\n    const newLabel: TabLabel = {\n        name: labelName.trim(),\n        id: crypto.randomUUID(),\n        displayName: labelName.trim(),\n    };\n    // Avoid duplicates\n    if (!settings.labels.some((l) => l.name === newLabel.name)) {\n        settings.labels.push(newLabel);\n        await saveSettings(settings);\n    }\n}\n\n/**\n * Removes a label by ID.\n */\nexport async function removeLabel(labelId: string): Promise<void> {\n    const settings = await getSettings();\n    settings.labels = settings.labels.filter((l) => l.id !== labelId);\n    await saveSettings(settings);\n}\n\n/**\n * Updates an existing label.\n */\nexport async function updateLabel(labelId: string, updates: Partial<TabLabel>): Promise<void> {\n    const settings = await getSettings();\n    const index = settings.labels.findIndex((l) => l.id === labelId);\n    if (index !== -1) {\n        settings.labels[index] = { ...settings.labels[index], ...updates };\n        await saveSettings(settings);\n    }\n}\n\n/**\n * Updates the order of labels.\n */\nexport async function updateLabelOrder(newLabels: TabLabel[]): Promise<void> {\n    const settings = await getSettings();\n    settings.labels = newLabels;\n    await saveSettings(settings);\n}\n", "/**\n * options.ts\n *\n * Logic for the options page.\n * Handles adding, removing, and reordering labels.\n */\n\nimport { getSettings, saveSettings, addLabel, removeLabel, updateLabelOrder, TabLabel } from './utils/storage';\n\nconst labelList = document.getElementById('labels-list') as HTMLDivElement; // Changed from listElement\nconst newLabelInput = document.getElementById('new-label-input') as HTMLInputElement; // Changed from inputElement\nconst addBtn = document.getElementById('add-btn') as HTMLButtonElement;\nconst exportBtn = document.getElementById('export-btn') as HTMLButtonElement;\nconst importBtn = document.getElementById('import-btn') as HTMLButtonButtonElement;\nconst importFile = document.getElementById('import-file') as HTMLInputElement;\nconst themeSelect = document.getElementById('theme-select') as HTMLSelectElement;\n\n// Initial setup and event listeners\ndocument.addEventListener('DOMContentLoaded', async () => {\n    const settings = await getSettings();\n    renderList(); // Initial render of labels\n\n    // Set initial theme selection\n    if (themeSelect) {\n        themeSelect.value = settings.theme;\n    }\n\n    // Handle Theme Change\n    themeSelect?.addEventListener('change', async () => {\n        const theme = themeSelect.value as 'system' | 'light' | 'dark';\n        await saveSettings({ theme });\n    });\n});\n\n\n// Render the list of labels\nasync function renderList() {\n    const settings = await getSettings();\n    labelList.innerHTML = '';\n\n    settings.labels.forEach((label, index) => {\n        const li = document.createElement('li');\n        li.draggable = true;\n        li.dataset.id = label.id;\n        li.dataset.index = index.toString();\n\n        li.innerHTML = `\n      <div style=\"display: flex; align-items: center;\">\n        <span class=\"drag-handle\">\u2630</span>\n        <span>${escapeHtml(label.name)}</span>\n      </div>\n      <button class=\"remove-btn\" title=\"Remove\">\u2715</button>\n    `;\n\n        // Remove handler\n        const removeBtn = li.querySelector('.remove-btn') as HTMLButtonElement;\n        removeBtn.addEventListener('click', async () => {\n            await removeLabel(label.id);\n            renderList();\n        });\n\n        // Drag events\n        li.addEventListener('dragstart', handleDragStart);\n        li.addEventListener('dragover', handleDragOver);\n        li.addEventListener('drop', handleDrop);\n        li.addEventListener('dragenter', handleDragEnter);\n        li.addEventListener('dragleave', handleDragLeave);\n\n        labelList.appendChild(li);\n    });\n}\n\n// Add new label\naddBtn.addEventListener('click', async () => {\n    const name = newLabelInput.value;\n    if (name) {\n        await addLabel(name);\n        newLabelInput.value = '';\n        renderList();\n    }\n});\n\n// Allow Enter key to submit\nnewLabelInput.addEventListener('keypress', (e) => {\n    if (e.key === 'Enter') {\n        addBtn.click();\n    }\n});\n\n// Export settings\nexportBtn.addEventListener('click', async () => {\n    const settings = await getSettings();\n    const dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(settings));\n    const downloadAnchorNode = document.createElement('a');\n    downloadAnchorNode.setAttribute(\"href\", dataStr);\n    downloadAnchorNode.setAttribute(\"download\", \"gmail_tabs_settings.json\");\n    document.body.appendChild(downloadAnchorNode); // required for firefox\n    downloadAnchorNode.click();\n    downloadAnchorNode.remove();\n});\n\n// Import settings\nimportBtn.addEventListener('click', () => {\n    importFile.click();\n});\n\nimportFile.addEventListener('change', (event) => {\n    const file = (event.target as HTMLInputElement).files?.[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = async (e) => {\n        try {\n            const content = e.target?.result as string;\n            const settings = JSON.parse(content);\n            if (Array.isArray(settings.labels)) {\n                await saveSettings(settings);\n                renderList();\n                alert('Settings imported successfully!');\n            } else {\n                alert('Invalid JSON format.');\n            }\n        } catch (err) {\n            console.error(err);\n            alert('Error parsing JSON.');\n        }\n    };\n    reader.readAsText(file);\n});\n\n// Drag and Drop Logic\nlet dragSrcEl: HTMLElement | null = null;\n\nfunction handleDragStart(this: HTMLElement, e: DragEvent) {\n    dragSrcEl = this;\n    e.dataTransfer!.effectAllowed = 'move';\n    e.dataTransfer!.setData('text/html', this.innerHTML);\n    this.classList.add('dragging');\n}\n\nfunction handleDragOver(e: DragEvent) {\n    if (e.preventDefault) {\n        e.preventDefault();\n    }\n    e.dataTransfer!.dropEffect = 'move';\n    return false;\n}\n\nfunction handleDragEnter(this: HTMLElement) {\n    this.classList.add('over');\n}\n\nfunction handleDragLeave(this: HTMLElement) {\n    this.classList.remove('over');\n}\n\nasync function handleDrop(this: HTMLElement, e: DragEvent) {\n    if (e.stopPropagation) {\n        e.stopPropagation();\n    }\n\n    if (dragSrcEl !== this) {\n        const settings = await getSettings();\n        const oldIndex = parseInt(dragSrcEl!.dataset.index!);\n        const newIndex = parseInt(this.dataset.index!);\n\n        // Move item in array\n        const item = settings.labels.splice(oldIndex, 1)[0];\n        settings.labels.splice(newIndex, 0, item);\n\n        await updateLabelOrder(settings.labels);\n        renderList();\n    }\n    return false;\n}\n\nfunction escapeHtml(text: string) {\n    const map: { [key: string]: string } = {\n        '&': '&amp;',\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': '&quot;',\n        \"'\": '&#039;'\n    };\n    return text.replace(/[&<>\"']/g, function (m) { return map[m]; });\n}\n\n// Initial render\ndocument.addEventListener('DOMContentLoaded', renderList);\n"],
  "mappings": "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",
  "names": []
}
